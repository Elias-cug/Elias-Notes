<?xml version="1.0" encoding="UTF-8"?>
<server>
  <global>
    <!-- 快照数据文件存放路径 -->
    <snapshot>
      <property name="data.file.path" value="server/snapshot"/>
      <!-- 快照默认采样率，千分比-->
      <property name="snapshot.sample.rate" value="1"/>
    </snapshot>
    <!--线程剖析文件存放路径-->
    <threaddump>
      <property name="th.data.file.path" value="/server/threaddump"/>
    </threaddump>
    <!-- 公共日志输出路径(私有节点.log > global.log > default) -->
    <log>
      <property name="global.log.path" value="/ebpm/br/logs/server_monitor/"/>
    </log>
    <!-- 探针文件存储地址 -->
    <agent>
      <property name="agent.file.path" value="/server/agentfile"/>
    </agent>
    <!-- agent log 文件存放路径-->
    <agentlog>
      <property name="agentlog.file.path" value="/server/agentlog"/>
    </agentlog>
    <!--btlog文件存放路径-->
    <btlog>
      <property name="btlog.file.path" value="/server/btlog"/>
    </btlog>
    <!--快照和业务log存储方式【nfs，mysql】-->
    <storage>
      <property name="storage.type" value="nfs"/>
    </storage>
    <trace>
      <!-- tarce启用开关，on启用 off不启用-->
      <property name="trace.onoff" value="on"/>
      <!--trace存储模式true存mysql,false存hbase -->
      <property name="usemysql" value="false"/>
      <property name="trace.file.path" value="/server/trace"/>
      <!-- trace默认采样率，千分比-->
      <property name="trace.sample.rate" value="1"/>
      <!-- 使用brfs的前提是上述usemysql字段设置成false -->
      <!-- 连接brfs的用户名 -->
      <property name="brfs.username" value="root" />
      <!-- 连接brfs的密码 -->
      <property name="brfs.password" value="123456" />
      <!-- brfs写数据时缓存到regionnode的blocksize,该值必须能被16M（16,777,216）整除 -->
      <property name="brfs.package.size" value="65536" />
      <!-- 连接brfs的主机与端口 -->
      <property name="brfs.hosts" value="http://datanode01:6100,http://datanode02:6100" />
      <!-- 是否使用brfs进行存储，true存brfs,false存hbase -->
      <property name="store.brfs" value="true" />
      <!-- 是否有BRFS历史数据 -->
      <property name="brfs.used" value="false" />
      <!-- BRFS存储table名 -->
      <property name="brfs.storage.name" value="SERVER:TraceData"/>
    </trace>
    <wechat>
      <!-- 是否启用微信服务程序（true：启用、false：不启用） -->
      <property name="wechat.enable" value="false"/>
      <!-- wechat获取动态Token地址 -->
      <property name="wechat.token.url" value="http://10.240.60.161:38082/wechat/getToken"/>
      <!-- 微信服务程序url -->
      <property name="wechat.url" value="http://10.240.60.161:38082"/>
      <!-- wechat报警内容发送地址 -->
      <property name="wechat.alert.url" value="http://10.240.60.161:38082/wechat/validate/sendAlertMessage"/>
      <!-- 微信类型（0:公众号、1：企业微信） -->
      <property name="wechat.type" value="0"/>
    </wechat>
	<!-- 生成新的探针安装包脚本参数 -->
    <smartAgentTokenShell>
      <!-- controllerIp -->
      <property name="controller.ip" value="serverupload2.bonree.com"/>
      <!-- controllerPort -->
      <property name="controller.port" value="443"/>
      <!-- tokenPath -->
      <property name="token.path" value="/tokendownload/"/>
      <!-- controller Scheme （http or https）根据实际情况支持的协议填写 -->
      <property name="controller.scheme" value="https" />
    </smartAgentTokenShell>
    <!-- 插件 -->
    <plugin>
      <path>
        <property name="plugin.path" value="/ebpm/br/plugin"/>
      </path>
      <server>
        <!-- 企业微信默认插件,自定义插件名请勿与此插件名重复，wechat.type 为1时可用,为0时可以不用配置-->
        <qy_wechat>
          <property name="plugin.notice.name" value="qy_wechat_default_plugin"/>
          <property name="plugin.notice.description" value="qy_wechat default alert plugin"/>
          <property name="plugin.notice.type" value="cmd"/>
          <property name="plugin.notice.cmd" value="python3 qy_wechat_default_plugin.py"/>
        </qy_wechat>
        <!--可以新建多个alert节点代表多个插件,name不可重复,命令中路径必须为绝对路径 -->
        <notice>
          <property name="plugin.notice.name" value="alert_plugin_entry"/>
          <property name="plugin.notice.description" value="this is plugin_entry for alert."/>
          <property name="plugin.notice.type" value="cmd"/>
          <property name="plugin.notice.cmd" value="python3 plugin_entry.py"/>
        </notice>
      </server>
    </plugin>
    <!--大数据etl相关配置-->
    <apmstorm>
      <alert>
        <property name="alert.short.base.url" value="http://10.240.60.161:38082/server/q/"/>
      </alert>
    </apmstorm>
    <kafkaTopic>
        <property name="raw.metric.topic" value="ty_capas_server_metric_topic"/>
        <property name="raw.snapshot.topic" value="ty_capas_server_snapshot_topic"/>
        <property name="raw.trace.topic" value="ty_capas_server_trace_topic"/>
        <property name="raw.slow.backend.topic" value="ty_capas_server_slowbackend_topic"/>
        <property name="raw.errors.topic" value="ty_capas_server_errors_topic"/>
        <property name="raw.events.topic" value="ty_capas_server_events_topic"/>
        <property name="raw.machine.metric.topic" value="ty_capas_server_machinemetric_topic"/>
        <property name="raw.registration.topic" value="ty_capas_server_registration_topic"/>
        <property name="raw.modules.topic" value="ty_capas_server_modules_topic"/>
        <property name="raw.middle.metric.topic" value="ty_capas_server_biz_topic"/>
        <property name="raw.auto.report.topic" value="ty_capas_server_autoreport_topic"/>
    </kafkaTopic>
    <kafkaConsumerGroup>
        <property name="controller.kafka.consumer.group" value="gid_ty_server_controller"/>      
        <property name="autoreport.kafka.consumer.group" value="gid_ty_server_autoreport_topic"/>   
    </kafkaConsumerGroup>
    <delivery>
      <property name="delivery.kafka.host" value="http://10.200.188.19:9092,http://10.200.188.18:9092,http://10.200.188.17:9092"/>
      <!--10.240.47.52:9091,10.240.47.52:9092,10.240.47.52:9093" /> -->
      <property name="delivery.kafka.compression.type" value="snappy"/>
      <property name="delivery.connection.metadata.url" value="http://10.233.132.31:8085/v1"/>
      <!--http://10.240.48.50:80/v1" /> -->
      <property name="delivery.connection.username" value="BRSYSAPI"/>
      <property name="delivery.connection.token" value="7c591c7fef2557e1"/>
      <property name="delivery.datasource.snapshot.kafka.topic" value="TY_CAPAS_SERVER_DELIVERY_SNAPSHOT" datasource="server_data_snapshot_none"/>
      <property name="delivery.datasource.granule.kafka.topic" value="TY_CAPAS_SERVER_DELIVERY_GRAN" datasource="server_data_gran_five_second"/>
    </delivery>
  </global>
  <!-- web部分的配置信息统一在web节点下管理 -->
  <web>
    <!-- web部分多个模块公用的配置项 -->
    <common>
      <!-- Druid API查询url -->
      <interface>
        <property name="druid.api.url" value="http://10.233.132.31:8085/v1"/>
        <!-- Druid API查询admin万用token，仅用于自动报告和api这种无用户的查询 -->
        <property name="druid.api.token" value="7c591c7fef2557e1"/>
      </interface>
      <url>
      <!-- 日志易跳转链接 -->
            <property name="rizhiyi.url" value="http://devtest.ibr.cc:20202/auth/verify/admin/ed4da79ebbe90361f9db58c494b2ffc8/4024cd05a6418d22ed2fb96cd327d843" />
      </url>
      <!-- 截图服务 （自动报告、导出用到） -->
      <shotscreen>
        <!-- phantomjs安装目录 -->
        <property name="phantomjs.exe.path" value="/data/br/base/phantomjs/bin/phantomjs"/>
        <!-- 能访问截图服务的ip白名单 -->
        <property name="white.list">
          <list>
            <value>127.0.0.1</value>
                        <value>10.240.60.161</value>
                        <value>10.240.60.162</value>
                        <value>10.240.60.163</value>
                        <value>10.240.60.164</value>
                        <value>10.240.60.165</value>
                        <value>10.240.60.166</value>
                        <value>118.194.54.216</value>
                        <value>118.194.54.254</value>
                      </list>
        </property>
      </shotscreen>
      <!-- 密文登陆白名单 -->
      <login>
        <property name="login.white.list" >
          <list>
            <value>127.0.0.1</value>
          </list>
        </property>
        <!-- Referer白名单 -->
        <property name="referer.white.list">
          <list>
            <value>*.bonree.com</value>
            <value>*</value>
            <value>*.reedoun.com</value>
                        <value>10.240.60.161</value>
                        <value>10.240.60.162</value>
                        <value>10.240.60.163</value>
                        <value>10.240.60.164</value>
                        <value>10.240.60.165</value>
                        <value>10.240.60.166</value>
                        <value>10.233.132.31</value>        
              </list>
        </property>
      </login>
      <!-- 版本信息 -->
      <version>
        <!-- # 使用的数据库类型(填oracle或者mysql) -->
        <property name="database.type" value="mysql"/>
        <!-- 权限类型（1:公有云、2:私有化部署） -->
        <property name="authority.type" value="2"/>
        <!-- 是否单点登录 or账号打通（true:使用cas单点登录、false：不使用cas单点登录）-->
        <property name="is.sso" value="false"/>
        <!-- 博睿Server的url -->
        <property name="bonree.server.url" value="http://10.233.132.31:38082"/>
      </version>
      <!-- 线程剖析时间间隔配置项 -->
      <threadAnalysis>
        <!-- 时间间隔最小值（范围0-999） -->
        <property name="thread.min.value" value="1"/>
        <!-- 时间间隔默认值（范围 min-1000） -->
        <property name="thread.default.value" value="2"/>
      </threadAnalysis>
      <api>
        <!-- api校验白名单 -->
        <property name="api.white.list">
          <list>
                        <value>10.240.60.161</value>
                        <value>10.240.60.162</value>
                        <value>10.240.60.163</value>
                        <value>10.240.60.164</value>
                        <value>10.240.60.165</value>
                        <value>10.240.60.166</value>
                      </list>
        </property>
      </api>
	<property name="phone.number" value="400-680-8085" />
    </common>
    <!-- 外部调用 -->
    <rpc>
      <!-- 公有云Server的token -->
      <property name="server.token" value="7c591c7fef2557e1"/>
      <!-- browser上下文 -->
      <property name="browser.context" value="/browser"/>
      <!-- platform跳转用户中心路径 -->
      <property name="platform.userinfo" value="/platform/#/userInfo/list"/>
      <!-- server自动报告截图容器路径 -->
      <property name="autoreport.to.cahrt.agent" value="/server/autoreport/setting/toChartAgent"/>
    </rpc>
    <!-- 站长统计开关（true:启用、false：不启用） -->
    <cnzz>
      <!-- cnzzSwitch -->
      <property name="cnzz.switch" value="false" />
    </cnzz>
    <aiops>
      <!-- aiops相关模块开关（true:启用、false：不启用） -->
      <property name="aiops.switch" value="false" />
    </aiops>
  </web>
  <controller>
    <rpc>
      <!-- 数据融合server数据转发参数token -->
      <property name="bop.server.api.token" value="a13f60f8844a332d"/>
      <!-- 数据融合server系统用户 -->
      <property name="bop.server.sys.user" value="BRSYSAPI"/>
      <!-- 数据融合uri(controller根据此地址响应的appIds判断出哪些数据需要转发到融合平台 -->
      <property name="bop.load.app.config.uri" value="/base/data/loadAppConfig"/>
      <!-- browser的api接口参数token -->
      <property name="browser.api.token" value="3134996703dc39f9"/>
      <!-- browser的获取js-agent的uri -->
      <property name="browser.download.js.uri" value="/api/common"/>
      <!--  browser的api接口uri -->
      <property name="browser.api.token.uri" value="/token/getToken"/>
    </rpc>
    <data>
      <!-- 原始数据放入kafka是否启用压缩，0-不压缩，1-GZIP压缩 -->
      <property name="compress.flag" value="1"/>
      <!-- 上传数据的时间超过偏差值（分钟）,替换为服务器当前时间 -->
      <property name="deviation.min" value="15"/>
    </data>
    <aiops>
      <redis>
      <!-- aiops redis的集群ip -->
      <property name="cluster" value="10.240.60.167:7001,10.240.60.167:7002,10.240.60.168:7001,10.240.60.168:7002,10.240.60.169:7001,10.240.60.169:7002"/>
      <!-- aiops redis的登录密码 -->
      <property name="password" value="5CFC62EDC26468DD8954F206C3273FB9"/>
      <!-- aiops redis的版本号 -->
      <property name="version" value="5.0.6"/>
      <!-- aiops redis的key前缀 -->
      <property name="key.prefix" value="APM"/>
      </redis>
    </aiops>
  </controller>
</server>
